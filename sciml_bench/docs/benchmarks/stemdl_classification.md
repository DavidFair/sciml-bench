# stemdl_classification Benchmark

The Scanning Transmission Electron Microscope Deep Learning (STEM-DL) benchmark was developed at Oakridge National Laboratory (ORNL). This benchmark trains a machine learning model which allows to classify Convergent Beam Electron Diffraction (CBED) patterns into one of the 230 crystallographic space groups. These patterns are generated by simulation and represent over 60000 solid-state materials covering almost all known crystal structures. The motivation for this benchmark is to explore the suitability of machine learning algorithms for the advanced analysis of CBED [1, 2, 3, 4, 5].

* Entity Type: Benchmark
* Main Domain: Material Sciences
* Sub Domain: Convergent Beam Electron Diffraction
* Task: Classification of diffraction patterns
* Relevant Datasets: stemdl_classification_ds1
* Implementation: Pytorch
* Authors: Junqi Yin, Sajal Dash, Aris Tsaris, Feiyi Wang, Arjun Shankar

The benchmark supports data parallel training and runs on multiple GPUs.
For training use this command: 
sciml-bench run stemdl_classification --mode training -b epochs 1 -b batchsize 32 -b nodes 1 -b gpus 1

For inference use this command (update):


## References:
[1] N Laanait, J Yin, “NAMSA”, 10.11578/dc.20201001.90, 2019.
[2] N Laanait, A Borisevich, J Yin, “Database of Convergent Beam Electron Diffraction Patterns for Machine Learning of the Structural Properties of Materials”, 10.13139/OLCF/1510313, 2019.
[3] N Laanait, J Yin, A Borisevich, “Towards a Universal Classifier for Crystallographic Space Groups”, SMC data challenges, 2020.
[4] Jin Pan, “Probability Flow for Classifying Crystallographic Space Groups”, SMC 2020.
[5] N Laanait, J Romero, J Yin, M Young, S Treichler, V Starchenko, A Borisevich, A Sergeev, M Matheson, “Exascale deep learning for scientific inverse problems”, arxiv:1909.11150, 2019.








The benchmark, when run, by default, utilises the GPU if one available.  The benchmark does not support distributed training, and such, will not make use of more than one GPU, even if available. 

For training use this command:
sciml-bench run --mode training optical_damage

For inference use this command:
sciml-bench run --mode inference --model ~/sciml_bench/models/optical_damage/opticsModel.h5 --dataset_dir ~/sciml_bench/datasets/optical_damage_ds1 optical_damage

The benchmark uses on the following default parameters (update this section): 

* Batch size: `batch_size` = 32
* Number of epochs: `epochs` = 1
* Learning rate: `lr` = 0.01  
